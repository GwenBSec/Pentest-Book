## Host Discovery 

Questions to consider when mapping the network:
1. What hosts are discoverable on the subnet with a regular ping sweep? 
2. What hosts are discoverable on the subnet with a (no ping) ping sweep?
3. How many DNS servers exist in the network? (Name servers, MX record) 
4. Can you perform a zone transfer to find additional IP addresses?
5. Draw the network map 

### Fping
```bash
# Fping
fping -asgq 10.10.110.10/24
fping -f scope > pingsweep.txt
```

### Nmap 
```bash 
# Nmap ICMP & TCP on port 80 & 443 
nmap -sn -iL ips.txt > live-hosts.txt

# Nmap ICMP only 
nmap -PE ips.txt

# Nmap TCP only 
uses small list of ports to perform TCP scan - if any additional hosts show up these most likely will be sitting behind firewalls
nmap -n -sn -PS22,135,443,445 ips.txt

# Nmap DNS 
nmap -sS -sU -p53 <subnet>
```

### ARP 
```bash
# arp scanner 
run arp_scanner -r 10.10.100.10/24
```

### DNS 
```bash 
# DNS name servers 
>>nslookup 
>>server <IP>
>>set q=NS 
>>domain name 
look up each individual name server to find the IP address 

# DNS MX records
>>nslookup 
>>server <IP> 
>>set q=MX
>>domain name 
look up mail server to find the IP address

# DNS Zone Transfer 
dig @dns server <domain> -f AXFR +nocookie 
host -t axfr domain <dns server IP> 
```

### tcpdump  
```bash
# Lists available interfaces 
tcpdump -D 

# Specify interface (verbose output)
tcpdump -I eth1 -v 

# Disable DNS resolve (shows IP not hostnames) 
tcpdump -I eth1 -n 

# Quiet option (contains less information) 
tcpdump -I eth1 -q

# Target traffic for a specific host
tcpdump -I eth1 host <IP> 

# Creating filters (filtering port 80) 
nano filters.txt 
	Port 80
tcpdump -I eth1 -F filter.txt 

# Export traffic capture to .txt file
tcpdump -I eth1 -w output_file.txt 
```

### wireshark 
```bash
# capture filters
host x.x.x.x =
net x.x.x.x/24
port #
not port #
ip/ether/tcp

# display filters
ip.addr == x.x.x.x 
ip.addr == x.x.x.x/24 
ip.src == x.x.x.x 
ip.dest == x.x.x.x 
dns/tcp/ftp/arp/ip 
tcp.port == x
tcp.port == 21
src.port / dst.port == x and/or/not

# FTP filters
ftp.request.command                # shows commands send across FTP channel (users,passwords,etc.)
ftp-data                           # shows data transferred over channel (port 20) 
http.request.method == POST        # filter for POST requests (usernames & passwords)
```

### Internal ping sweep 
```bash
ip a
for i in {1..254} ;do (ping -c 1 192.168.1.$i | grep "bytes from" &) ;done
```
![image](https://github.com/GwenBSec/Pentest-Book/assets/88676386/4407294b-5f78-4924-81ed-0f8fe1489d37)

