## ESC3
ESC3, is to abuse Misconfigured Enrollment Agent Templates, which bears similarities to ESC1 and ESC2. However, it involves exploiting a different Extended Key Usage (EKU) and necessitates an additional step to carry out the abuse.

#### ECS3 Abuse Requirements
To abuse this for privilege escalation, a CA requires at least two templates matching the conditions below:

`Condition 1` - Involves a template that grants low-privileged users the ability to obtain an enrollment agent certificate. This condition is characterized by several specific details, which are consistent with those outlined in ESC1:
* The Enterprise CA grants low-privileged users enrollment rights (same as ESC1).
* Manager approval should be turned off (same as ESC1).
* No authorized signatures are required (same as ESC1).
* The security descriptor of the certificate template must be excessively permissive, allowing low-privileged users to enroll for certificates (same as ESC1).
* The certificate template includes the Certificate Request Agent EKU, specifically the Certificate Request Agent OID (1.3.6.1.4.1.311.20.2.1), allowing the requesting of other certificate templates on behalf of other principals.

`Condition 2` - Another template that permits low-privileged users to use the enrollment agent certificate to request certificates on behalf of other users. Additionally, this template defines an Extended Key Usage that allows for domain authentication. The conditions are as follows:
* The Enterprise CA grants low-privileged users enrollment rights (same as ESC1).
* Manager approval should be turned off (same as ESC1).
* The template schema version 1 or is greater than 2 and specifies an Application Policy Issuance Requirement that necessitates the Certificate Request Agent EKU.
* The certificate template defines an EKU that enables domain authentication.
* No restrictions on enrollment agents are implemented at the CA level.
