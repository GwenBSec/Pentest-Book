## Enumeration 
### nmap scripts 
```bash
# nmap enum scripts
nmap --script "safe or smb-enum-*" -p 445 <IP>
nmap -v -p 139, 445 --script=smb-os-discovery <IP>
/usr/share/nmap/scripts/smb2-capabilities.nse
/usr/share/nmap/scripts/smb2-security-mode.nse
/usr/share/nmap/scripts/smb2-time.nse
/usr/share/nmap/scripts/smb-brute.nse
/usr/share/nmap/scripts/smb-double-pulsar-backdoor.nse
/usr/share/nmap/scripts/smb-enum-domains.nse
/usr/share/nmap/scripts/smb-enum-groups.nse
/usr/share/nmap/scripts/smb-enum-processes.nse
/usr/share/nmap/scripts/smb-enum-services.nse
/usr/share/nmap/scripts/smb-enum-sessions.nse
/usr/share/nmap/scripts/smb-enum-shares.nse
/usr/share/nmap/scripts/smb-enum-users.nse
/usr/share/nmap/scripts/smb-flood.nse
/usr/share/nmap/scripts/smb-ls.nse
/usr/share/nmap/scripts/smb-mbenum.nse
/usr/share/nmap/scripts/smb-os-discovery.nse
/usr/share/nmap/scripts/smb-print-text.nse
/usr/share/nmap/scripts/smb-protocols.nse
/usr/share/nmap/scripts/smb-psexec.nse
/usr/share/nmap/scripts/smb-security-mode.nse
/usr/share/nmap/scripts/smb-server-stats.nse
/usr/share/nmap/scripts/smb-system-info.nse

# nmap (all vulns) scans
nmap --script smb-vuln*.nse -p 139,445 $target -Pn -oN smb-vuln-scan

$ # nmap vuln scripts 
/usr/share/nmap/scripts/smb2-vuln-uptime.nse
/usr/share/nmap/scripts/smb-vuln-conficker.nse
/usr/share/nmap/scripts/smb-vuln-cve2009-3103.nse
/usr/share/nmap/scripts/smb-vuln-cve-2017-7494.nse
/usr/share/nmap/scripts/smb-vuln-ms06-025.nse
/usr/share/nmap/scripts/smb-vuln-ms07-029.nse
/usr/share/nmap/scripts/smb-vuln-ms08-067.nse
/usr/share/nmap/scripts/smb-vuln-ms10-054.nse
/usr/share/nmap/scripts/smb-vuln-ms10-061.nse
/usr/share/nmap/scripts/smb-vuln-ms17-010.nse
/usr/share/nmap/scripts/smb-vuln-regsvc-dos.nse
/usr/share/nmap/scripts/smb-vuln-webexec.nse
/usr/share/nmap/scripts/smb-webexec-exploit.nse
```

### smbclient 
```bash
# list shared folders 
smbclient -N -L //IP
smblicent --no-pass -L //IP

# connect to shared folder 
smbclient //IP/notes
smbclient --no-pass //<IP>/<Folder>
smbclient -U 'username[%passwd]' -L [--pw-nt-hash] //<IP>                                                  # If you omit the pwd, it will be prompted. With --pw-nt-hash, the pwd provided is the NT hash
# Use --no-pass -c 'recurse;ls'  to list recursively with smbclient

smbclient -U '' //IP/share
smbclient -U user \\\\IP\\share_name
smbclient -U '%' -N \\\\<IP>\\<SHARE> # null session to connect to a windows share
smbclient -U '<USER>' \\\\<IP>\\<SHARE> # authenticated session to connect to a windows share (you will be prompted for a password)
smbclient -L \\\\192.168.120.181\\ -U 'V.Ventz%HotelCalifornia194!'
smbclient //10.10.10.100/Users -U active.htb\\SVC_TGS%GPPstillStandingStrong2k18 
smbclient \\\\192.168.124.175\\Password\ Audit -U 'V.Ventz%HotelCalifornia194!'

# download all files 
>mask ""
>prompt off
>recurse on
>mget*
```
### smbmap 
```bash
smbmap -H <IP>

# connect to shared folder 
smbmap -H <IP> -r <share>
smbmap [-u "username" -p "password"] -R [Folder] -H <IP> [-P <PORT>] # Recursive list
smbmap [-u "username" -p "password"] -r [Folder] -H <IP> [-P <PORT>] # Non-Recursive list
smbmap -u "username" -p "<NT>:<LM>" [-r/-R] [Folder] -H <IP> [-P <PORT>] # Pass-the-Hash
smbmap -H 10.10.10.100 -d active.htb -u SVC_TGS -p GPPstillStandingStrong2k18

# download file 
smbmap -H <IP> --download "notes\note.txt"
smbmap -R Folder -H <IP> -A <FileName> -q
```

### rpcclient 
```bash
rpcclient -U "" -N <IP>
rpcclient -U "" <IP>
rpcclient -U'%' <IP>
    >srvinfo
    >enumdomains
    >querydominfo
    >netshareenumall
    >netsharegetinfo <share>
    >enumdomusers
    >enumdomgroups
    >queryuser <RID>
    >querygroup <RID>
    >lookupnames <user>
rpcclient -U htb.local/james --password=J@m3s_P@ssW0rd! 10.10.10.52
rpcclient //machine.htb -U domain.local/USERNAME%754d87d42adabcca32bdb34a876cbffb  --pw-nt-hash
rpcclient -U "username%passwd" <IP> #With creds
```

### enum4linux 
```bash
enum4linux -a <IP>
enum4linux -a [-u "<username>" -p "<passwd>"] <IP>
enum4linux-ng -A [-u "<username>" -p "<passwd>"] <IP>
```

### crackmapexec 
```bash
# enumerate hosts (OS version, SMB version, IP, domain) 
crackmapexec smb <subnet>

# null access 
crackmapexec smb <IP> -u '' -p ''

# list shares
crackmapexec smb <IP> -u <USER> -p <PASS> --shares

# download files
cme smb <IP> -u <u> -p <p> -M spider_plus -o READ_ONLY=false
crackmapexec smb <IP> -u user -p password --share IT --get-file Creds.txt Creds.txt

# enum users, groups, & loggod on users
crackmapexec smb 10.10.10.10 --users [-u <username> -p <password>]
crackmapexec smb 10.10.10.10 --groups [-u <username> -p <password>]
crackmapexec smb 10.10.10.10 --groups --loggedon-users [-u <username> -p <password>]

```

### change password 
```bash
smbpassword -r <IP> -U <user>
```

### mount shared folder 
```bash
mount -t cifs //x.x.x.x/share /mnt/share
mount -t cifs -o "username=user,password=password" //x.x.x.x/share /mnt/share
```








